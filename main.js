/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => VaultExpoterPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// src/fseditor.ts
var import_obsidian = require("obsidian");
var FsEditor = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.fs = require("fs");
    this.path = require("path");
  }
  get root() {
    let a = this.plugin.app.vault.adapter;
    return a.basePath.replace(/\\/g, "/");
  }
  abspath(tfile) {
    if (tfile) {
      return this.root + "/" + tfile.path;
    } else {
      return null;
    }
  }
  isfile(path) {
    return this.fs.existsSync(path) && this.fs.statSync(path).isFile();
  }
  isdir(path) {
    return this.fs.existsSync(path) && this.fs.statSync(path).isDirectory();
  }
  first_valid_dir(paths) {
    for (let path of paths) {
      if (this.isdir(path)) {
        return path;
      }
    }
    return null;
  }
  async select_valid_dir(paths) {
    let xpaths = paths.filter((p) => this.isdir(p));
    if (xpaths.length === 0) {
      return null;
    } else if (xpaths.length == 1) {
      return xpaths[0];
    } else {
      let nc = this.plugin.app.plugins.getPlugin("note-chain");
      if (nc) {
        let path = await nc.chain.tp_suggester(xpaths, xpaths);
        return path;
      } else {
        return null;
      }
    }
  }
  mkdir_recursive(path) {
    if (this.isdir(path)) {
      return true;
    }
    const parent = this.path.dirname(path);
    if (!this.isdir(parent)) {
      this.mkdir_recursive(parent);
    }
    this.fs.mkdirSync(path);
  }
  /**
  * 附件 src 到 dst，不在 vault 中，需要绝对路径
  * overwrite，复盖；mtime，新文件；
  */
  copy_file(src, dst, mode = "pass>overwrite>mtime") {
    const fs = this.fs;
    mode = mode.split(">")[0];
    if (!fs.existsSync(src)) {
      return false;
    }
    if (fs.existsSync(dst)) {
      if (mode === "overwrite") {
        fs.unlinkSync(dst);
        fs.copyFileSync(src, dst);
        new import_obsidian.Notice(`Copy:${src}-->${dst}`, 5e3);
        return true;
      } else if (mode === "mtime") {
        if (fs.statSync(dst).mtimeMs < fs.statSync(src).mtimeMs) {
          fs.unlinkSync(dst);
          fs.copyFileSync(src, dst);
          new import_obsidian.Notice(`Copy:${src}-->${dst}`, 5e3);
          return true;
        }
      }
    } else {
      fs.copyFileSync(src, dst);
      new import_obsidian.Notice(`Copy:${src}-->${dst}`, 5e3);
      return true;
    }
    return false;
  }
  copy_tfile(tfile, dst, mode = "mtime") {
    if (tfile) {
      let src = this.abspath(tfile);
      return src && this.copy_file(src, dst, mode);
    }
    return false;
  }
  mirror_tfile(tfile, vault_root, mode = "mtime", attachment = true, outlink = false) {
    if (tfile) {
      vault_root = vault_root.replace(/\\/g, "/");
      let src = this.root + "/" + tfile.path;
      let dst = vault_root + "/" + tfile.path;
      this.mkdir_recursive(this.path.dirname(dst));
      this.copy_file(src, dst, mode);
      if (attachment) {
        console.log("attachment");
        let nc = this.plugin.app.plugins.getPlugin("note-chain");
        if (!nc) {
          return;
        }
        let tfiles = nc.chain.get_outlinks(tfile, false);
        for (let t of tfiles) {
          console.log(t.name);
          if (!(t.extension === "md")) {
            this.mirror_tfile(t, vault_root, mode, false);
          } else if (outlink) {
            this.mirror_tfile(t, vault_root, mode, false);
          }
        }
      }
    }
  }
  mirror_tfolder(tfolder, vault_root, mode = "mtime", attachment = true, outlink = false) {
    if (tfolder) {
      for (let t of tfolder.children) {
        if (t instanceof import_obsidian.TFolder) {
          this.mirror_tfolder(t, vault_root, mode, attachment, outlink);
        } else if (t instanceof import_obsidian.TFile) {
          this.mirror_tfile(t, vault_root, mode, attachment, outlink);
        }
      }
    }
  }
  modify(path, callback, encoding = "utf8") {
    const fs = this.fs;
    if (!fs.existsSync(path)) {
      return;
    }
    ;
    fs.readFile(
      path,
      encoding,
      (err, data) => {
        if (err) {
          console.error("Error reading file:", err);
          ;
        }
        let rs = callback(path, data);
        fs.writeFile(path, rs, encoding, (err2) => {
          if (err2) {
            console.error("Error writing file:", err2);
          } else {
            console.log("File content updated successfully.");
          }
        });
      }
    );
  }
};

// src/strings.ts
var Strings = class {
  constructor() {
    let lang = window.localStorage.getItem("language");
    if (lang) {
      this.language = lang;
    } else {
      this.language = "en";
    }
  }
  get cmd_export_current_note() {
    if (this.language == "zh") {
      return "\u5BFC\u51FA\u5F53\u524D\u7B14\u8BB0";
    } else {
      return "Export current note";
    }
  }
  get cmd_set_vexporter() {
    if (this.language == "zh") {
      return "\u8BBE\u7F6E\u5BFC\u51FA\u7B14\u8BB0\u9009\u9879";
    } else {
      return "Set config to export note";
    }
  }
  get cmd_export_plugin() {
    if (this.language == "zh") {
      return "\u5BFC\u51FA\u63D2\u4EF6";
    } else {
      return "Export plugin";
    }
  }
  get prompt_path_of_folder() {
    if (this.language == "zh") {
      return "\u8F93\u5165\u6587\u4EF6\u5939\u8DEF\u5F84";
    } else {
      return "Input path of folder";
    }
  }
  get notice_output() {
    if (this.language == "zh") {
      return "\u5BFC\u51FA\uFF1A";
    } else {
      return "Output:";
    }
  }
  get notice_nosuchdir() {
    if (this.language == "zh") {
      return "\u65E0\u6548\u76EE\u5F55";
    } else {
      return "Invaid path.";
    }
  }
  get setting_plugin_dir() {
    if (this.language == "zh") {
      return "\u63D2\u4EF6\u5BFC\u51FA\u76EE\u5F55";
    } else {
      return "Plugin dir to export";
    }
  }
  get setting_vault_dir() {
    if (this.language == "zh") {
      return "\u5E93\u76EE\u5F55";
    } else {
      return "Root dir of vault";
    }
  }
};
var strings = new Strings();

// main.ts
var DEFAULT_SETTINGS = {
  pluginDirExporter: "",
  vaultDir: ""
};
var cmd_export_current_note = (plugin) => ({
  id: "cmd_export_current_note",
  name: strings.cmd_export_current_note,
  callback: async () => {
    const nc = plugin.notechain;
    let tfile = nc.chain.current_note;
    await plugin.export_readme(tfile, null);
  }
});
var cmd_set_vexporter = (plugin) => ({
  id: "cmd_set_vexporter",
  name: strings.cmd_set_vexporter,
  callback: async () => {
    const nc = plugin.notechain;
    let dir = await nc.chain.tp_prompt(strings.prompt_path_of_folder);
    let item = {};
    if (plugin.fsEditor.fs.existsSync(dir)) {
      item["Dir"] = dir;
    }
    item["Name"] = "readMe";
    item["Assets"] = "./assets";
    item["RemoveMeta"] = true;
    item["UseGitLink"] = true;
    await nc.editor.set_frontmatter(
      nc.chain.current_note,
      "vexporter",
      item
    );
  }
});
var cmd_export_plugin = (plugin) => ({
  id: "cmd_export_plugin",
  name: strings.cmd_export_plugin,
  callback: async () => {
    const nc = plugin.notechain;
    let plugins = Object.keys(plugin.app.plugins.plugins);
    let p = await nc.chain.tp_suggester(plugins, plugins);
    let eplugin = plugin.app.plugins.getPlugin(p);
    if (eplugin) {
      let target = await plugin.fsEditor.select_valid_dir(
        plugin.settings.pluginDirExporter.split("\n")
      );
      if (!plugin.fsEditor.fs.existsSync(target)) {
        target = await nc.chain.tp_prompt(strings.prompt_path_of_folder);
      }
      target = target.replace(/\\/g, "/");
      if (!target.endsWith("/" + p)) {
        target = target + "/" + p;
      }
      if (!plugin.fsEditor.fs.existsSync(target)) {
        plugin.fsEditor.fs.mkdirSync(target);
      }
      let items = ["main.js", "manifest.json", "styles.css"];
      for (let item of items) {
        let src = `${plugin.fsEditor.root}/${eplugin.manifest.dir}/${item}`;
        let dst = `${target}/${item}`;
        plugin.fsEditor.copy_file(src, dst, "overwrite");
      }
    }
  }
});
var commandBuilders = [
  cmd_export_current_note,
  cmd_set_vexporter,
  cmd_export_plugin
];
function addCommands(plugin) {
  commandBuilders.forEach((c) => {
    plugin.addCommand(c(plugin));
  });
}
var VaultExpoterPlugin = class extends import_obsidian2.Plugin {
  async onload() {
    await this.loadSettings();
    this.fsEditor = new FsEditor(this);
    this.addSettingTab(new VExporterSettingTab(this.app, this));
    addCommands(this);
    this.registerEvent(
      this.app.workspace.on("file-menu", (menu, file) => {
        menu.addItem((item) => {
          item.setTitle("Mirror to other vault").setIcon("document").onClick(async () => {
            let dst = await this.fsEditor.select_valid_dir(
              this.settings.vaultDir.split("\n")
            );
            if (!dst) {
              let nc = this.app.plugins.getPlugin("note-chain");
              if (!nc) {
                new import_obsidian2.Notice("Plugin note-chain is needed!");
                return;
              }
              dst = await nc.chain.tp_prompt("Root of vault");
              if (!this.fsEditor.isdir(dst)) {
                new import_obsidian2.Notice("Invalid root: " + dst);
                return;
              }
            }
            if (file instanceof import_obsidian2.TFile) {
              this.fsEditor.mirror_tfile(file, dst, "mtime", true, false);
            } else if (file instanceof import_obsidian2.TFolder) {
              this.fsEditor.mirror_tfolder(file, dst, "mtime", true, false);
            }
          });
        });
      })
    );
  }
  onunload() {
  }
  get notechain() {
    return this.app.plugins.getPlugin("note-chain");
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async export_readme(tfile, dst) {
    var _a, _b, _c, _d;
    let nc = this.app.plugins.getPlugin("note-chain");
    if (!tfile) {
      tfile = nc.chain.current_note;
    }
    if (!dst) {
      dst = (_a = nc.editor.get_frontmatter(tfile, "vexporter")) == null ? void 0 : _a.Dir;
      if (!dst) {
        dst = await nc.chain.tp_prompt("Path of LocalGitProject");
      }
    }
    if (!dst || !this.fsEditor.fs.existsSync(dst)) {
      new import_obsidian2.Notice(strings.notice_nosuchdir, 3e3);
      return;
    }
    dst = dst.replace(/\\/g, "/");
    let tmp;
    let name = (_b = nc.editor.get_frontmatter(tfile, "vexporter")) == null ? void 0 : _b.Name;
    if (name && !(name === "")) {
      tmp = dst + "/" + name + ".md";
    } else {
      tmp = dst + "/" + tfile.basename + ".md";
    }
    if (this.fsEditor.copy_tfile(tfile, tmp)) {
      if ((_c = nc.editor.get_frontmatter(tfile, "vexporter")) == null ? void 0 : _c.RemoveMeta) {
        const ufunc = (path, data) => {
          var _a2, _b2;
          let res = data;
          if ((_a2 = nc.editor.get_frontmatter(tfile, "vexporter")) == null ? void 0 : _a2.RemoveMeta) {
            res = res.replace(
              /---[\n(\r\n)][\s\S]*?---[\n(\r\n)]/,
              ""
            );
          }
          if (((_b2 = nc.editor.get_frontmatter(tfile, "vexporter")) == null ? void 0 : _b2.UseGitLink) && assets) {
            res = res.replace(
              /\!\[\[(.*?)\]\]/g,
              (match, name2) => {
                return `![${name2}](${assets}/${name2.replace(/ /g, "%20")})`;
              }
            );
          }
          return res;
        };
        await this.fsEditor.modify(tmp, ufunc);
      }
    }
    let assets = (_d = nc.editor.get_frontmatter(tfile, "vexporter")) == null ? void 0 : _d.Assets;
    if (assets) {
      let olinks = nc.chain.get_outlinks(tfile);
      let adir = dst + "/" + assets;
      this.fsEditor.mkdir_recursive(adir);
      for (let f of olinks) {
        if (!(f.extension === "md")) {
          this.fsEditor.copy_tfile(f, adir + "/" + f.basename + "." + f.extension);
        }
      }
    }
  }
};
var VExporterSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  getSettingValue(field) {
    return this.plugin.settings[field];
  }
  add_toggle(name, desc, field) {
    const { containerEl } = this;
    let value = this.plugin.settings[field];
    let item = new import_obsidian2.Setting(containerEl).setName(name).setDesc(desc).addToggle(
      (text) => text.setValue(value).onChange(async (value2) => {
        this.plugin.settings[field] = value2;
        await this.plugin.saveSettings();
      })
    );
    return item;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName(strings.setting_plugin_dir).addTextArea((text) => text.setValue(this.plugin.settings.pluginDirExporter).onChange(async (value) => {
      this.plugin.settings.pluginDirExporter = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName(strings.setting_vault_dir).addTextArea((text) => text.setValue(this.plugin.settings.vaultDir).onChange(async (value) => {
      this.plugin.settings.vaultDir = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvZnNlZGl0b3IudHMiLCAic3JjL3N0cmluZ3MudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCAqIGFzIE1vZHVsZSBmcm9tICdtb2R1bGUnO1xyXG5pbXBvcnQgeyBBcHAsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBNb2RhbCwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGaWxlLCBURm9sZGVyIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuaW1wb3J0IHsgRnNFZGl0b3IgfSBmcm9tICdzcmMvZnNlZGl0b3InO1xyXG5pbXBvcnQgeyBzdHJpbmdzIH0gZnJvbSAnc3JjL3N0cmluZ3MnO1xyXG5cclxuaW50ZXJmYWNlIFZFeHBvcnRlclNldHRpbmdzIHtcclxuXHRwbHVnaW5EaXJFeHBvcnRlcjpzdHJpbmc7XHJcblx0dmF1bHREaXI6c3RyaW5nO1xyXG59XHJcblxyXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBWRXhwb3J0ZXJTZXR0aW5ncyA9IHtcclxuXHRwbHVnaW5EaXJFeHBvcnRlcjonJyxcclxuXHR2YXVsdERpcjonJ1xyXG59XHJcblxyXG5cclxuY29uc3QgY21kX2V4cG9ydF9jdXJyZW50X25vdGUgPSAocGx1Z2luOlZhdWx0RXhwb3RlclBsdWdpbikgPT4gKHtcclxuXHRpZDogJ2NtZF9leHBvcnRfY3VycmVudF9ub3RlJyxcclxuXHRuYW1lOiBzdHJpbmdzLmNtZF9leHBvcnRfY3VycmVudF9ub3RlLFxyXG5cdGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcblx0XHRjb25zdCBuYyA9IHBsdWdpbi5ub3RlY2hhaW47XHJcblx0XHRsZXQgdGZpbGUgPSBuYy5jaGFpbi5jdXJyZW50X25vdGU7XHJcblx0XHRhd2FpdCBwbHVnaW4uZXhwb3J0X3JlYWRtZSh0ZmlsZSxudWxsKTtcclxuXHR9XHJcbn0pO1xyXG5cclxuY29uc3QgY21kX3NldF92ZXhwb3J0ZXIgPSAocGx1Z2luOlZhdWx0RXhwb3RlclBsdWdpbikgPT4gKHtcclxuXHRpZDogJ2NtZF9zZXRfdmV4cG9ydGVyJyxcclxuXHRuYW1lOiBzdHJpbmdzLmNtZF9zZXRfdmV4cG9ydGVyLFxyXG5cdGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcblx0XHRjb25zdCBuYyA9IHBsdWdpbi5ub3RlY2hhaW47XHJcblx0XHRsZXQgZGlyID0gYXdhaXQgbmMuY2hhaW4udHBfcHJvbXB0KHN0cmluZ3MucHJvbXB0X3BhdGhfb2ZfZm9sZGVyKTtcclxuXHRcdGxldCBpdGVtOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0ge307XHJcblx0XHRpZihwbHVnaW4uZnNFZGl0b3IuZnMuZXhpc3RzU3luYyhkaXIpKXtcclxuXHRcdFx0aXRlbVsnRGlyJ10gPSBkaXI7XHJcblx0XHR9XHJcblx0XHRpdGVtWydOYW1lJ10gPSAncmVhZE1lJztcclxuXHRcdGl0ZW1bJ0Fzc2V0cyddID0gJy4vYXNzZXRzJztcclxuXHRcdGl0ZW1bJ1JlbW92ZU1ldGEnXSA9IHRydWU7XHJcblx0XHRpdGVtWydVc2VHaXRMaW5rJ10gPSB0cnVlO1xyXG5cclxuXHRcdGF3YWl0IG5jLmVkaXRvci5zZXRfZnJvbnRtYXR0ZXIoXHJcblx0XHRcdG5jLmNoYWluLmN1cnJlbnRfbm90ZSxcclxuXHRcdFx0J3ZleHBvcnRlcicsXHJcblx0XHRcdGl0ZW1cclxuXHRcdClcclxuXHR9XHJcbn0pO1xyXG5cclxuY29uc3QgY21kX2V4cG9ydF9wbHVnaW4gPSAocGx1Z2luOlZhdWx0RXhwb3RlclBsdWdpbikgPT4gKHtcclxuXHRpZDogJ2NtZF9leHBvcnRfcGx1Z2luJyxcclxuXHRuYW1lOiBzdHJpbmdzLmNtZF9leHBvcnRfcGx1Z2luLFxyXG5cdGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcblx0XHRjb25zdCBuYyA9IHBsdWdpbi5ub3RlY2hhaW47XHJcblx0XHRcclxuXHRcdGxldCBwbHVnaW5zID0gT2JqZWN0LmtleXMoKHBsdWdpbi5hcHAgYXMgYW55KS5wbHVnaW5zLnBsdWdpbnMpO1xyXG5cdFx0bGV0IHAgPSBhd2FpdCBuYy5jaGFpbi50cF9zdWdnZXN0ZXIocGx1Z2lucyxwbHVnaW5zKTtcclxuXHRcdGxldCBlcGx1Z2luID0gKHBsdWdpbi5hcHAgYXMgYW55KS5wbHVnaW5zLmdldFBsdWdpbihwKTtcclxuXHRcdGlmKGVwbHVnaW4pe1xyXG5cdFx0XHRsZXQgdGFyZ2V0ID0gYXdhaXQgcGx1Z2luLmZzRWRpdG9yLnNlbGVjdF92YWxpZF9kaXIoXHJcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLnBsdWdpbkRpckV4cG9ydGVyLnNwbGl0KFwiXFxuXCIpXHJcblx0XHRcdClcclxuXHRcdFx0aWYoIXBsdWdpbi5mc0VkaXRvci5mcy5leGlzdHNTeW5jKHRhcmdldCkpe1xyXG5cdFx0XHRcdHRhcmdldCA9IGF3YWl0IG5jLmNoYWluLnRwX3Byb21wdChzdHJpbmdzLnByb21wdF9wYXRoX29mX2ZvbGRlcik7XHJcblx0XHRcdH1cclxuXHRcdFx0dGFyZ2V0ID0gdGFyZ2V0LnJlcGxhY2UoL1xcXFwvZywnLycpO1xyXG5cdFx0XHRpZighdGFyZ2V0LmVuZHNXaXRoKCcvJyArIHApKXtcclxuXHRcdFx0XHR0YXJnZXQgPSB0YXJnZXQgKyAnLycgKyBwO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCFwbHVnaW4uZnNFZGl0b3IuZnMuZXhpc3RzU3luYyh0YXJnZXQpKXtcclxuXHRcdFx0XHRwbHVnaW4uZnNFZGl0b3IuZnMubWtkaXJTeW5jKHRhcmdldCk7XHJcblx0XHRcdH1cclxuXHRcdFx0bGV0IGl0ZW1zID0gWydtYWluLmpzJywnbWFuaWZlc3QuanNvbicsJ3N0eWxlcy5jc3MnXTtcclxuXHRcdFx0Zm9yKGxldCBpdGVtIG9mIGl0ZW1zKXtcclxuXHRcdFx0XHRsZXQgc3JjID0gYCR7cGx1Z2luLmZzRWRpdG9yLnJvb3R9LyR7ZXBsdWdpbi5tYW5pZmVzdC5kaXJ9LyR7aXRlbX1gO1xyXG5cdFx0XHRcdGxldCBkc3QgPSBgJHt0YXJnZXR9LyR7aXRlbX1gO1xyXG5cdFx0XHRcdHBsdWdpbi5mc0VkaXRvci5jb3B5X2ZpbGUoc3JjLGRzdCwnb3ZlcndyaXRlJyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn0pO1xyXG5cclxuY29uc3QgY29tbWFuZEJ1aWxkZXJzID0gW1xyXG5cdGNtZF9leHBvcnRfY3VycmVudF9ub3RlLFxyXG5cdGNtZF9zZXRfdmV4cG9ydGVyLFxyXG5cdGNtZF9leHBvcnRfcGx1Z2luXHJcbl07XHJcblxyXG5mdW5jdGlvbiBhZGRDb21tYW5kcyhwbHVnaW46VmF1bHRFeHBvdGVyUGx1Z2luKSB7XHJcbiAgICBjb21tYW5kQnVpbGRlcnMuZm9yRWFjaCgoYykgPT4ge1xyXG4gICAgICAgIHBsdWdpbi5hZGRDb21tYW5kKGMocGx1Z2luKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmF1bHRFeHBvdGVyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogVkV4cG9ydGVyU2V0dGluZ3M7XHJcblx0ZnNFZGl0b3IgOiBGc0VkaXRvcjtcclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cdFx0dGhpcy5mc0VkaXRvciA9IG5ldyBGc0VkaXRvcih0aGlzKTtcclxuXHRcdC8vIFRoaXMgYWRkcyBhIHNldHRpbmdzIHRhYiBzbyB0aGUgdXNlciBjYW4gY29uZmlndXJlIHZhcmlvdXMgYXNwZWN0cyBvZiB0aGUgcGx1Z2luXHJcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IFZFeHBvcnRlclNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHRcdGFkZENvbW1hbmRzKHRoaXMpO1xyXG5cclxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcclxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZmlsZS1tZW51XCIsIChtZW51LCBmaWxlKSA9PiB7XHJcblx0XHRcdFx0bWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XHJcblx0XHRcdFx0XHRpdGVtXHJcblx0XHRcdFx0XHQuc2V0VGl0bGUoXCJNaXJyb3IgdG8gb3RoZXIgdmF1bHRcIilcclxuXHRcdFx0XHRcdC5zZXRJY29uKFwiZG9jdW1lbnRcIilcclxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdFx0bGV0IGRzdCA9IGF3YWl0IHRoaXMuZnNFZGl0b3Iuc2VsZWN0X3ZhbGlkX2RpcihcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLnZhdWx0RGlyLnNwbGl0KFwiXFxuXCIpXHJcblx0XHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHRcdGlmKCFkc3Qpe1xyXG5cdFx0XHRcdFx0XHRcdGxldCBuYz0gKHRoaXMuYXBwIGFzIGFueSkucGx1Z2lucy5nZXRQbHVnaW4oXCJub3RlLWNoYWluXCIpO1xyXG5cdFx0XHRcdFx0XHRcdGlmKCFuYyl7XHJcblx0XHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKFwiUGx1Z2luIG5vdGUtY2hhaW4gaXMgbmVlZGVkIVwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0ZHN0ID0gYXdhaXQgbmMuY2hhaW4udHBfcHJvbXB0KFwiUm9vdCBvZiB2YXVsdFwiKTtcclxuXHRcdFx0XHRcdFx0XHRpZighdGhpcy5mc0VkaXRvci5pc2Rpcihkc3QpKXtcclxuXHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJJbnZhbGlkIHJvb3Q6IFwiICsgZHN0KTtcclxuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKXtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmZzRWRpdG9yLm1pcnJvcl90ZmlsZShmaWxlLGRzdCwnbXRpbWUnLHRydWUsZmFsc2UpO1xyXG5cclxuXHRcdFx0XHRcdFx0fWVsc2UgaWYoZmlsZSBpbnN0YW5jZW9mIFRGb2xkZXIpe1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuZnNFZGl0b3IubWlycm9yX3Rmb2xkZXIoZmlsZSxkc3QsJ210aW1lJyx0cnVlLGZhbHNlKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0pXHJcblx0XHQpO1xyXG5cdH1cclxuXHJcblx0b251bmxvYWQoKSB7XHJcblxyXG5cdH1cclxuXHJcblx0Z2V0IG5vdGVjaGFpbigpe1xyXG5cdFx0cmV0dXJuICh0aGlzLmFwcCBhcyBhbnkpLnBsdWdpbnMuZ2V0UGx1Z2luKCdub3RlLWNoYWluJyk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcblx0fVxyXG5cdFxyXG5cdGFzeW5jIGV4cG9ydF9yZWFkbWUodGZpbGU6VEZpbGUsZHN0OnN0cmluZ3xudWxsKXtcclxuXHRcdGxldCBuYyA9ICh0aGlzLmFwcCBhcyBhbnkpLnBsdWdpbnMuZ2V0UGx1Z2luKCdub3RlLWNoYWluJyk7XHJcblx0XHRpZighdGZpbGUpe3RmaWxlID0gbmMuY2hhaW4uY3VycmVudF9ub3RlO31cclxuXHRcdFxyXG5cdFx0Ly8gXHU4QkJFXHU3RjZFXHU4RjkzXHU1MUZBXHU3NkVFXHU1RjU1XHJcblx0XHRpZighZHN0KXtcclxuXHRcdFx0ZHN0ID0gbmMuZWRpdG9yLmdldF9mcm9udG1hdHRlcih0ZmlsZSwndmV4cG9ydGVyJyk/LkRpcjtcclxuXHRcdFx0aWYoIWRzdCl7XHJcblx0XHRcdFx0ZHN0ID0gYXdhaXQgbmMuY2hhaW4udHBfcHJvbXB0KCdQYXRoIG9mIExvY2FsR2l0UHJvamVjdCcpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZighZHN0IHx8ICF0aGlzLmZzRWRpdG9yLmZzLmV4aXN0c1N5bmMoZHN0KSl7XHJcblx0XHRcdG5ldyBOb3RpY2Uoc3RyaW5ncy5ub3RpY2Vfbm9zdWNoZGlyLDMwMDApO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRkc3QgPSBkc3QucmVwbGFjZSgvXFxcXC9nLCcvJyk7XHJcblx0XHRcclxuXHRcdFxyXG5cdFx0Ly8gXHU1QkZDXHU1MUZBXHU1RjUzXHU1MjREXHU3QjE0XHU4QkIwXHJcblx0XHRsZXQgdG1wO1xyXG5cdFx0bGV0IG5hbWUgPSBuYy5lZGl0b3IuZ2V0X2Zyb250bWF0dGVyKHRmaWxlLCd2ZXhwb3J0ZXInKT8uTmFtZTtcclxuXHRcdGlmKG5hbWUgJiYgIShuYW1lPT09JycpKXtcclxuXHRcdFx0dG1wID0gZHN0KycvJytuYW1lKycubWQnO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdHRtcCA9IGRzdCsnLycrdGZpbGUuYmFzZW5hbWUrJy5tZCc7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYodGhpcy5mc0VkaXRvci5jb3B5X3RmaWxlKHRmaWxlLHRtcCkpe1xyXG5cdFx0XHRpZihuYy5lZGl0b3IuZ2V0X2Zyb250bWF0dGVyKHRmaWxlLCd2ZXhwb3J0ZXInKT8uUmVtb3ZlTWV0YSl7XHJcblx0XHRcdFx0Y29uc3QgdWZ1bmMgPSAocGF0aDpzdHJpbmcsZGF0YTpzdHJpbmcpPT57XHJcblx0XHRcdFx0XHRsZXQgcmVzID0gZGF0YTtcclxuXHRcdFx0XHRcdGlmKG5jLmVkaXRvci5nZXRfZnJvbnRtYXR0ZXIodGZpbGUsJ3ZleHBvcnRlcicpPy5SZW1vdmVNZXRhKXtcclxuXHRcdFx0XHRcdFx0cmVzID0gcmVzLnJlcGxhY2UoXHJcblx0XHRcdFx0XHRcdFx0Ly0tLVtcXG4oXFxyXFxuKV1bXFxzXFxTXSo/LS0tW1xcbihcXHJcXG4pXS8sXHJcblx0XHRcdFx0XHRcdFx0JydcclxuXHRcdFx0XHRcdFx0KVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYobmMuZWRpdG9yLmdldF9mcm9udG1hdHRlcih0ZmlsZSwndmV4cG9ydGVyJyk/LlVzZUdpdExpbmsgJiYgYXNzZXRzKXtcclxuXHRcdFx0XHRcdFx0cmVzID0gcmVzLnJlcGxhY2UoXHJcblx0XHRcdFx0XHRcdFx0L1xcIVxcW1xcWyguKj8pXFxdXFxdL2csXHJcblx0XHRcdFx0XHRcdFx0KG1hdGNoOmFueSwgbmFtZTpzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBgIVske25hbWV9XSgke2Fzc2V0c30vJHtuYW1lLnJlcGxhY2UoLyAvZywnJTIwJyl9KWA7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHQpXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm4gcmVzXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGF3YWl0IHRoaXMuZnNFZGl0b3IubW9kaWZ5KHRtcCx1ZnVuYyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdC8vIFx1NUJGQ1x1NTFGQVx1OTY0NFx1NEVGNlxyXG5cdFx0bGV0IGFzc2V0cyA9IG5jLmVkaXRvci5nZXRfZnJvbnRtYXR0ZXIodGZpbGUsJ3ZleHBvcnRlcicpPy5Bc3NldHM7XHJcblx0XHRpZihhc3NldHMpe1xyXG5cdFx0XHRsZXQgb2xpbmtzID0gbmMuY2hhaW4uZ2V0X291dGxpbmtzKHRmaWxlKTtcclxuXHRcdFx0bGV0IGFkaXIgPSBkc3QrJy8nK2Fzc2V0cztcclxuXHRcdFx0dGhpcy5mc0VkaXRvci5ta2Rpcl9yZWN1cnNpdmUoYWRpcik7XHJcblx0XHRcdGZvcihsZXQgZiBvZiBvbGlua3Mpe1xyXG5cdFx0XHRcdGlmKCEoZi5leHRlbnNpb249PT0nbWQnKSl7XHJcblx0XHRcdFx0XHR0aGlzLmZzRWRpdG9yLmNvcHlfdGZpbGUoZixhZGlyKycvJytmLmJhc2VuYW1lKycuJytmLmV4dGVuc2lvbik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBWRXhwb3J0ZXJTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcblx0cGx1Z2luOiBWYXVsdEV4cG90ZXJQbHVnaW47XHJcblx0XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFZhdWx0RXhwb3RlclBsdWdpbikge1xyXG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xyXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcblx0fVxyXG5cclxuXHRnZXRTZXR0aW5nVmFsdWUoZmllbGQ6IGtleW9mIFZFeHBvcnRlclNldHRpbmdzKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5wbHVnaW4uc2V0dGluZ3NbZmllbGRdO1xyXG5cdH1cclxuXHJcblx0YWRkX3RvZ2dsZShuYW1lOnN0cmluZyxkZXNjOnN0cmluZyxmaWVsZDprZXlvZiBWRXhwb3J0ZXJTZXR0aW5ncyl7XHJcblx0XHRjb25zdCB7Y29udGFpbmVyRWx9ID0gdGhpcztcclxuXHRcdGxldCB2YWx1ZSA9ICh0aGlzLnBsdWdpbi5zZXR0aW5ncyBhcyBhbnkpW2ZpZWxkXSBhcyBib29sZWFuO1xyXG5cdFx0bGV0IGl0ZW0gPSBuZXcgU2V0dGluZyhjb250YWluZXJFbCkgIFxyXG5cdFx0XHQuc2V0TmFtZShuYW1lKVxyXG5cdFx0XHQuc2V0RGVzYyhkZXNjKVxyXG5cdFx0XHQuYWRkVG9nZ2xlKHRleHQgPT4gdGV4dFxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh2YWx1ZSlcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOm5ldmVyKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5nc1tmaWVsZF0gPSB2YWx1ZTtcclxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblx0XHRyZXR1cm4gaXRlbTtcclxuXHR9XHJcblxyXG5cdGRpc3BsYXkoKTogdm9pZCB7XHJcblx0XHRjb25zdCB7Y29udGFpbmVyRWx9ID0gdGhpcztcclxuXHJcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cdFx0XHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoc3RyaW5ncy5zZXR0aW5nX3BsdWdpbl9kaXIpXHJcblx0XHRcdC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHRleHRcclxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucGx1Z2luRGlyRXhwb3J0ZXIpXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGx1Z2luRGlyRXhwb3J0ZXIgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdH0pKTtcclxuXHRcdFxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdFx0LnNldE5hbWUoc3RyaW5ncy5zZXR0aW5nX3ZhdWx0X2RpcilcclxuXHRcdFx0XHQuYWRkVGV4dEFyZWEodGV4dCA9PiB0ZXh0XHJcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudmF1bHREaXIpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnZhdWx0RGlyID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSkpO1xyXG5cdH1cclxufVxyXG4iLCAiXHJcbmltcG9ydCB7IEFwcCwgRWRpdG9yLCBNYXJrZG93blZpZXcsIE1vZGFsLCBOb3RpY2UsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgVEZpbGUsIFRGb2xkZXIgfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5leHBvcnQgY2xhc3MgRnNFZGl0b3J7XHJcbiAgICBmcztcclxuICAgIHBhdGg7XHJcbiAgICBwbHVnaW4gOlBsdWdpbjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46UGx1Z2luKXtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLmZzID0gcmVxdWlyZSgnZnMnKTtcclxuICAgICAgICB0aGlzLnBhdGggPSByZXF1aXJlKCdwYXRoJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHJvb3QoKXtcclxuICAgICAgICBsZXQgYSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyIGFzIGFueTtcclxuICAgICAgICByZXR1cm4gYS5iYXNlUGF0aC5yZXBsYWNlKC9cXFxcL2csJy8nKTtcclxuICAgIH1cclxuXHJcbiAgICBhYnNwYXRoKHRmaWxlOlRGaWxlKXtcclxuXHRcdGlmKHRmaWxlKXtcclxuXHRcdFx0cmV0dXJuIHRoaXMucm9vdCsnLycrdGZpbGUucGF0aDtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG4gICAgaXNmaWxlKHBhdGg6c3RyaW5nKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5mcy5leGlzdHNTeW5jKHBhdGgpICYmIHRoaXMuZnMuc3RhdFN5bmMocGF0aCkuaXNGaWxlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNkaXIocGF0aDpzdHJpbmcpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZzLmV4aXN0c1N5bmMocGF0aCkgJiYgdGhpcy5mcy5zdGF0U3luYyhwYXRoKS5pc0RpcmVjdG9yeSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGZpcnN0X3ZhbGlkX2RpcihwYXRoczpBcnJheTxzdHJpbmc+fHN0cmluZyl7XHJcbiAgICAgICAgZm9yKGxldCBwYXRoIG9mIHBhdGhzKXtcclxuICAgICAgICAgICAgaWYodGhpcy5pc2RpcihwYXRoKSl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBzZWxlY3RfdmFsaWRfZGlyKHBhdGhzOkFycmF5PHN0cmluZz4pe1xyXG4gICAgICAgIGxldCB4cGF0aHMgPSBwYXRocy5maWx0ZXIoKHA6c3RyaW5nKT0+dGhpcy5pc2RpcihwKSk7XHJcbiAgICAgICAgaWYoeHBhdGhzLmxlbmd0aD09PTApe1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9ZWxzZSBpZih4cGF0aHMubGVuZ3RoPT0xKXtcclxuICAgICAgICAgICAgcmV0dXJuIHhwYXRoc1swXTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgbGV0IG5jID0gKHRoaXMucGx1Z2luLmFwcCBhcyBhbnkpLnBsdWdpbnMuZ2V0UGx1Z2luKCdub3RlLWNoYWluJyk7XHJcbiAgICAgICAgICAgIGlmKG5jKXtcclxuICAgICAgICAgICAgICAgIGxldCBwYXRoID0gYXdhaXQgbmMuY2hhaW4udHBfc3VnZ2VzdGVyKHhwYXRocyx4cGF0aHMpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdGg7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuXHJcbiAgICBta2Rpcl9yZWN1cnNpdmUocGF0aDpzdHJpbmcpe1xyXG4gICAgICAgIGlmKHRoaXMuaXNkaXIocGF0aCkpe3JldHVybiB0cnVlO31cclxuICAgICAgICBjb25zdCBwYXJlbnQgPSB0aGlzLnBhdGguZGlybmFtZShwYXRoKTtcclxuICAgICAgICBpZighdGhpcy5pc2RpcihwYXJlbnQpKXtcclxuICAgICAgICAgICAgdGhpcy5ta2Rpcl9yZWN1cnNpdmUocGFyZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5mcy5ta2RpclN5bmMocGF0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcblx0KiBcdTk2NDRcdTRFRjYgc3JjIFx1NTIzMCBkc3RcdUZGMENcdTRFMERcdTU3MjggdmF1bHQgXHU0RTJEXHVGRjBDXHU5NzAwXHU4OTgxXHU3RUREXHU1QkY5XHU4REVGXHU1Rjg0XHJcblx0KiBvdmVyd3JpdGVcdUZGMENcdTU5MERcdTc2RDZcdUZGMUJtdGltZVx1RkYwQ1x1NjVCMFx1NjU4N1x1NEVGNlx1RkYxQlxyXG5cdCovXHJcbiAgICBjb3B5X2ZpbGUoc3JjOnN0cmluZyxkc3Q6c3RyaW5nLG1vZGU9J3Bhc3M+b3ZlcndyaXRlPm10aW1lJykge1xyXG4gICAgICAgIGNvbnN0IGZzID0gdGhpcy5mcztcclxuXHJcbiAgICAgICAgbW9kZSA9IG1vZGUuc3BsaXQoJz4nKVswXVxyXG4gICAgICAgIGlmKCFmcy5leGlzdHNTeW5jKHNyYykpe1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGZzLmV4aXN0c1N5bmMoZHN0KSl7XHJcbiAgICAgICAgICAgIGlmKG1vZGU9PT0nb3ZlcndyaXRlJyl7XHJcbiAgICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKGRzdCk7XHJcbiAgICAgICAgICAgICAgICBmcy5jb3B5RmlsZVN5bmMoc3JjLGRzdCk7XHJcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBDb3B5OiR7c3JjfS0tPiR7ZHN0fWAsNTAwMCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfWVsc2UgaWYobW9kZT09PSdtdGltZScpe1xyXG4gICAgICAgICAgICAgICAgLy8gZHN0IFx1NjZGNFx1NjVCMFx1NjVGNlx1OTVGNFx1NUMwRlx1NEU4RSBzcmNcclxuICAgICAgICAgICAgICAgIGlmKGZzLnN0YXRTeW5jKGRzdCkubXRpbWVNczxmcy5zdGF0U3luYyhzcmMpLm10aW1lTXMpe1xyXG4gICAgICAgICAgICAgICAgICAgIGZzLnVubGlua1N5bmMoZHN0KTtcclxuICAgICAgICAgICAgICAgICAgICBmcy5jb3B5RmlsZVN5bmMoc3JjLGRzdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgQ29weToke3NyY30tLT4ke2RzdH1gLDUwMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGZzLmNvcHlGaWxlU3luYyhzcmMsZHN0KTtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShgQ29weToke3NyY30tLT4ke2RzdH1gLDUwMDApO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNvcHlfdGZpbGUodGZpbGU6VEZpbGUsIGRzdDpzdHJpbmcsbW9kZT0nbXRpbWUnKSB7XHJcblx0XHRpZih0ZmlsZSl7XHJcblx0XHRcdGxldCBzcmMgPSB0aGlzLmFic3BhdGgodGZpbGUpO1xyXG5cdFx0XHRyZXR1cm4gc3JjICYmIHRoaXMuY29weV9maWxlKHNyYyxkc3QsbW9kZSk7XHJcblx0XHR9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcbiAgICBtaXJyb3JfdGZpbGUodGZpbGU6VEZpbGUsdmF1bHRfcm9vdDpzdHJpbmcsbW9kZT0nbXRpbWUnLGF0dGFjaG1lbnQ9dHJ1ZSxvdXRsaW5rPWZhbHNlKXtcclxuICAgICAgICAvLyBcdTVDMDZcdTdCMTRcdThCQjBcdTk1NUNcdTUwQ0ZcdTc5RkJcdTUyQThcdTUyMzBcdTUyMkJcdTc2ODRcdTVFOTNcdTRFMkRcdUZGMENcdTY1ODdcdTRFRjZcdTdFRDNcdTY3ODRcdTRFMEVcdTVGNTNcdTUyNERcdTVFOTNcdTc2RjhcdTU0MENcclxuICAgICAgICBpZih0ZmlsZSl7XHJcbiAgICAgICAgICAgIHZhdWx0X3Jvb3QgPSB2YXVsdF9yb290LnJlcGxhY2UoL1xcXFwvZywnLycpO1xyXG5cdFx0XHRsZXQgc3JjID0gdGhpcy5yb290ICsgJy8nICsgdGZpbGUucGF0aDtcclxuICAgICAgICAgICAgbGV0IGRzdCA9IHZhdWx0X3Jvb3QrJy8nK3RmaWxlLnBhdGg7XHJcbiAgICAgICAgICAgIHRoaXMubWtkaXJfcmVjdXJzaXZlKHRoaXMucGF0aC5kaXJuYW1lKGRzdCkpO1xyXG5cdFx0XHR0aGlzLmNvcHlfZmlsZShzcmMsZHN0LG1vZGUpO1xyXG4gICAgICAgICAgICBpZihhdHRhY2htZW50KXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhdHRhY2htZW50JylcclxuICAgICAgICAgICAgICAgIGxldCBuYyA9ICh0aGlzLnBsdWdpbi5hcHAgYXMgYW55KS5wbHVnaW5zLmdldFBsdWdpbignbm90ZS1jaGFpbicpO1xyXG4gICAgICAgICAgICAgICAgaWYoIW5jKXtyZXR1cm47fVxyXG4gICAgICAgICAgICAgICAgbGV0IHRmaWxlcyA9IG5jLmNoYWluLmdldF9vdXRsaW5rcyh0ZmlsZSxmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IobGV0IHQgb2YgdGZpbGVzKXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0Lm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoISh0LmV4dGVuc2lvbj09PSdtZCcpKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5taXJyb3JfdGZpbGUodCx2YXVsdF9yb290LG1vZGUsZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKG91dGxpbmspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1pcnJvcl90ZmlsZSh0LHZhdWx0X3Jvb3QsbW9kZSxmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblx0XHR9XHJcbiAgICB9XHJcblxyXG4gICAgbWlycm9yX3Rmb2xkZXIodGZvbGRlcjpURm9sZGVyLHZhdWx0X3Jvb3Q6c3RyaW5nLG1vZGU9J210aW1lJyxhdHRhY2htZW50PXRydWUsb3V0bGluaz1mYWxzZSl7XHJcbiAgICAgICAgaWYodGZvbGRlcil7XHJcbiAgICAgICAgICAgIGZvcihsZXQgdCBvZiB0Zm9sZGVyLmNoaWxkcmVuKXtcclxuICAgICAgICAgICAgICAgIGlmKHQgaW5zdGFuY2VvZiBURm9sZGVyKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1pcnJvcl90Zm9sZGVyKHQsdmF1bHRfcm9vdCxtb2RlLGF0dGFjaG1lbnQsb3V0bGluayk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZih0IGluc3RhbmNlb2YgVEZpbGUpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWlycm9yX3RmaWxlKHQsdmF1bHRfcm9vdCxtb2RlLGF0dGFjaG1lbnQsb3V0bGluayk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHRcdH1cclxuICAgIH1cclxuXHJcbiAgICBtb2RpZnkocGF0aDpzdHJpbmcsY2FsbGJhY2s6RnVuY3Rpb24sZW5jb2Rpbmc9J3V0ZjgnKXtcclxuICAgICAgICBjb25zdCBmcyA9IHRoaXMuZnM7XHJcbiAgICAgICAgaWYoIWZzLmV4aXN0c1N5bmMocGF0aCkpe3JldHVybn07XHJcblxyXG4gICAgICAgIGZzLnJlYWRGaWxlKHBhdGgsIGVuY29kaW5nLCAoZXJyOkVycm9yLCBkYXRhOnN0cmluZykgPT4ge1xyXG5cdFx0XHRpZihlcnIpe1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVhZGluZyBmaWxlOicsIGVycik7O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBycyA9IGNhbGxiYWNrKHBhdGgsZGF0YSk7XHJcblx0XHRcdGZzLndyaXRlRmlsZShwYXRoLCBycywgZW5jb2RpbmcsIChlcnI6RXJyb3IpID0+IHtcclxuXHRcdFx0ICBpZiAoZXJyKSB7XHJcblx0XHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3Igd3JpdGluZyBmaWxlOicsIGVycik7XHJcblx0XHRcdCAgfSBlbHNlIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnRmlsZSBjb250ZW50IHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5LicpO1xyXG5cdFx0XHQgIH1cclxuXHRcdFx0fSk7XHJcblx0XHQgIH1cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcbiIsICJcclxuY2xhc3MgU3RyaW5nc3tcclxuICAgIGxhbmd1YWdlOnN0cmluZztcclxuICAgIGNvbnN0cnVjdG9yKCl7XHJcbiAgICAgICAgbGV0IGxhbmcgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xhbmd1YWdlJyk7XHJcbiAgICAgICAgaWYobGFuZyl7XHJcbiAgICAgICAgICAgIHRoaXMubGFuZ3VhZ2UgPSBsYW5nO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLmxhbmd1YWdlID0gJ2VuJztcclxuICAgICAgICB9XHJcblx0fVxyXG5cclxuICAgIGdldCBjbWRfZXhwb3J0X2N1cnJlbnRfbm90ZSgpe1xyXG4gICAgICAgIGlmKHRoaXMubGFuZ3VhZ2U9PSd6aCcpe1xyXG4gICAgICAgICAgICByZXR1cm4gJ1x1NUJGQ1x1NTFGQVx1NUY1M1x1NTI0RFx1N0IxNFx1OEJCMCdcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuICdFeHBvcnQgY3VycmVudCBub3RlJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGNtZF9zZXRfdmV4cG9ydGVyKCl7XHJcbiAgICAgICAgaWYodGhpcy5sYW5ndWFnZT09J3poJyl7XHJcbiAgICAgICAgICAgIHJldHVybiAnXHU4QkJFXHU3RjZFXHU1QkZDXHU1MUZBXHU3QjE0XHU4QkIwXHU5MDA5XHU5ODc5J1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICByZXR1cm4gJ1NldCBjb25maWcgdG8gZXhwb3J0IG5vdGUnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXQgY21kX2V4cG9ydF9wbHVnaW4oKXtcclxuICAgICAgICBpZih0aGlzLmxhbmd1YWdlPT0nemgnKXtcclxuICAgICAgICAgICAgcmV0dXJuICdcdTVCRkNcdTUxRkFcdTYzRDJcdTRFRjYnXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHJldHVybiAnRXhwb3J0IHBsdWdpbic7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldCBwcm9tcHRfcGF0aF9vZl9mb2xkZXIoKXtcclxuICAgICAgICBpZih0aGlzLmxhbmd1YWdlPT0nemgnKXtcclxuICAgICAgICAgICAgcmV0dXJuICdcdThGOTNcdTUxNjVcdTY1ODdcdTRFRjZcdTU5MzlcdThERUZcdTVGODQnXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHJldHVybiAnSW5wdXQgcGF0aCBvZiBmb2xkZXInO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXQgbm90aWNlX291dHB1dCgpe1xyXG4gICAgICAgIGlmKHRoaXMubGFuZ3VhZ2U9PSd6aCcpe1xyXG4gICAgICAgICAgICByZXR1cm4gJ1x1NUJGQ1x1NTFGQVx1RkYxQSdcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuICdPdXRwdXQ6JztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgbm90aWNlX25vc3VjaGRpcigpe1xyXG4gICAgICAgIGlmKHRoaXMubGFuZ3VhZ2U9PSd6aCcpe1xyXG4gICAgICAgICAgICByZXR1cm4gJ1x1NjVFMFx1NjU0OFx1NzZFRVx1NUY1NSdcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuICdJbnZhaWQgcGF0aC4nO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXQgc2V0dGluZ19wbHVnaW5fZGlyKCl7XHJcbiAgICAgICAgaWYodGhpcy5sYW5ndWFnZT09J3poJyl7XHJcbiAgICAgICAgICAgIHJldHVybiAnXHU2M0QyXHU0RUY2XHU1QkZDXHU1MUZBXHU3NkVFXHU1RjU1JztcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuICdQbHVnaW4gZGlyIHRvIGV4cG9ydCc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldCBzZXR0aW5nX3ZhdWx0X2Rpcigpe1xyXG4gICAgICAgIGlmKHRoaXMubGFuZ3VhZ2U9PSd6aCcpe1xyXG4gICAgICAgICAgICByZXR1cm4gJ1x1NUU5M1x1NzZFRVx1NUY1NSc7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHJldHVybiAnUm9vdCBkaXIgb2YgdmF1bHQnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGxldCBzdHJpbmdzID0gbmV3IFN0cmluZ3MoKTsiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0EsSUFBQUEsbUJBQTRHOzs7QUNBNUcsc0JBQTRHO0FBRXJHLElBQU0sV0FBTixNQUFjO0FBQUEsRUFLakIsWUFBWSxRQUFjO0FBQ3RCLFNBQUssU0FBUztBQUNkLFNBQUssS0FBSyxRQUFRLElBQUk7QUFDdEIsU0FBSyxPQUFPLFFBQVEsTUFBTTtBQUFBLEVBQzlCO0FBQUEsRUFFQSxJQUFJLE9BQU07QUFDTixRQUFJLElBQUksS0FBSyxPQUFPLElBQUksTUFBTTtBQUM5QixXQUFPLEVBQUUsU0FBUyxRQUFRLE9BQU0sR0FBRztBQUFBLEVBQ3ZDO0FBQUEsRUFFQSxRQUFRLE9BQVk7QUFDdEIsUUFBRyxPQUFNO0FBQ1IsYUFBTyxLQUFLLE9BQUssTUFBSSxNQUFNO0FBQUEsSUFDNUIsT0FBSztBQUNK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QyxVQUFJLE9BQU8sTUFBSSxNQUFJO0FBQ25CLFdBQUssU0FBUyxnQkFBZ0IsSUFBSTtBQUNsQyxlQUFRLEtBQUssUUFBTztBQUNuQixZQUFHLEVBQUUsRUFBRSxjQUFZLE9BQU07QUFDeEIsZUFBSyxTQUFTLFdBQVcsR0FBRSxPQUFLLE1BQUksRUFBRSxXQUFTLE1BQUksRUFBRSxTQUFTO0FBQUEsUUFDL0Q7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFDRDtBQUVBLElBQU0sc0JBQU4sY0FBa0Msa0NBQWlCO0FBQUEsRUFJbEQsWUFBWSxLQUFVLFFBQTRCO0FBQ2pELFVBQU0sS0FBSyxNQUFNO0FBQ2pCLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLGdCQUFnQixPQUFnQztBQUMvQyxXQUFPLEtBQUssT0FBTyxTQUFTLEtBQUs7QUFBQSxFQUNsQztBQUFBLEVBRUEsV0FBVyxNQUFZLE1BQVksT0FBOEI7QUFDaEUsVUFBTSxFQUFDLFlBQVcsSUFBSTtBQUN0QixRQUFJLFFBQVMsS0FBSyxPQUFPLFNBQWlCLEtBQUs7QUFDL0MsUUFBSSxPQUFPLElBQUkseUJBQVEsV0FBVyxFQUNoQyxRQUFRLElBQUksRUFDWixRQUFRLElBQUksRUFDWjtBQUFBLE1BQVUsVUFBUSxLQUNqQixTQUFTLEtBQUssRUFDZCxTQUFTLE9BQU9DLFdBQWdCO0FBQ2hDLGFBQUssT0FBTyxTQUFTLEtBQUssSUFBSUE7QUFDOUIsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLENBQUM7QUFBQSxJQUNGO0FBQ0QsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLFVBQWdCO0FBQ2YsVUFBTSxFQUFDLFlBQVcsSUFBSTtBQUV0QixnQkFBWSxNQUFNO0FBRWxCLFFBQUkseUJBQVEsV0FBVyxFQUNyQixRQUFRLFFBQVEsa0JBQWtCLEVBQ2xDLFlBQVksVUFBUSxLQUNuQixTQUFTLEtBQUssT0FBTyxTQUFTLGlCQUFpQixFQUMvQyxTQUFTLE9BQU8sVUFBVTtBQUMxQixXQUFLLE9BQU8sU0FBUyxvQkFBb0I7QUFDekMsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ2hDLENBQUMsQ0FBQztBQUVKLFFBQUkseUJBQVEsV0FBVyxFQUNwQixRQUFRLFFBQVEsaUJBQWlCLEVBQ2pDLFlBQVksVUFBUSxLQUNuQixTQUFTLEtBQUssT0FBTyxTQUFTLFFBQVEsRUFDdEMsU0FBUyxPQUFPLFVBQVU7QUFDMUIsV0FBSyxPQUFPLFNBQVMsV0FBVztBQUNoQyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDaEMsQ0FBQyxDQUFDO0FBQUEsRUFDTjtBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiZXJyIiwgIl9hIiwgIl9iIiwgIm5hbWUiLCAidmFsdWUiXQp9Cg==
